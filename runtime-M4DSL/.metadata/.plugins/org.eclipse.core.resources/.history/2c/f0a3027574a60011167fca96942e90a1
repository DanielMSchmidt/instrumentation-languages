import datatypes;

pattern create(type)
	'_record = new 'type'();'
	
pattern collect (value)
	'_record.'#value' = 'value';'
	
pattern time (t)
	'_record.'#t' = MonitoringController.getTimeSource().getTime();'
	
pattern activate (probeId,body)
	'if (MonitoringController.isProbeActive('probeId')) {'body'
	}'

probe OperationExecution {
	record {
		Time tin
		Time tout
		StateMachine sm
	}
	start scope StateMachine 'BEGIN_BLOCK'> {
		activate ('sm_'StateMachine.name,create('OperationExecutionRecord')time(tin))
	}
	end scope StateMachine <'END_BLOCK' {
		activate ('sm_'StateMachine.name,time(tout))
	}
}